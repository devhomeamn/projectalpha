<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>My Activity</title>  <!-- ✅ Fixed -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" href="css/layout.css" />
  <link rel="stylesheet" href="css/profile.css" />

  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded" rel="stylesheet" />
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <div id="sidebar"></div>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Topbar -->
      <div id="topbar"></div>

      <!-- Page Content -->
      <section class="content">
        <div class="page-header">
          <div class="header-content">
            <div class="header-main">
              <h1 class="header-title">
                <span class="material-symbols-rounded header-icon">dashboard</span>
                My Activity
              </h1>
              <p class="header-subtitle">
                আপনার এন্ট্রি করা রেকর্ডসমূহের বিস্তারিত সামারি ও পরিসংখ্যান
              </p>
            </div>

            <div class="header-meta">
              <div class="meta-item">
                <span class="material-symbols-rounded">calendar_today</span>
                <span id="currentDate">Loading...</span>
              </div>
              <div class="meta-item">
                <span class="material-symbols-rounded">schedule</span>
                <span id="currentTime">Loading...</span>
              </div>
            </div>
          </div>

          <!-- Optional subtle wave background -->
          <div class="header-wave"></div>
        </div>

        <div class="profile-layout">
          <!-- Left: User card -->
          <div class="card user-card">
            <div class="uc-head">
              <img id="pAvatar" class="uc-avatar"
                   src="https://robohash.org/sfrms-user.png?size=140x140"
                   alt="User Avatar" />
              <div class="uc-info">
                <div class="uc-name" id="pNameText">--</div>
                <div class="uc-role" id="pRoleText">--</div>
                <div class="uc-mail" id="pEmailText">--</div>
              </div>
            </div>

            <div class="uc-meta">
              <div class="row">
                <div class="k">Service ID</div>
                <div class="v" id="pServiceIdText">--</div>
              </div>
              <div class="row">
                <div class="k">Username</div>
                <div class="v" id="pUsernameText">--</div>
              </div>
              <div class="row">
                <div class="k">Assigned Section</div>
                <div class="v" id="pSectionText">--</div>
              </div>
            </div>

            <div class="uc-actions">
              <button class="btn outline" id="btnRefresh" type="button" title="Refresh stats">
                <span class="material-symbols-rounded">refresh</span>
                Refresh
              </button>
            </div>

            <div class="pw-section">
              <div class="pw-title">
                <span class="material-symbols-rounded">lock_reset</span>
                Change Password
              </div>

              <form id="changePasswordForm" class="pw-form" autocomplete="off">
                <label class="pw-label" for="currentPassword">Current Password</label>
                <div class="pw-input-wrap">
                  <input id="currentPassword" class="pw-input" type="password" required />
                  <button class="pw-toggle" type="button" data-target="currentPassword" aria-label="Show current password">
                    <span class="material-symbols-rounded">visibility</span>
                  </button>
                </div>

                <label class="pw-label" for="newPassword">New Password</label>
                <div class="pw-input-wrap">
                  <input id="newPassword" class="pw-input" type="password" minlength="6" required />
                  <button class="pw-toggle" type="button" data-target="newPassword" aria-label="Show new password">
                    <span class="material-symbols-rounded">visibility</span>
                  </button>
                </div>

                <label class="pw-label" for="confirmPassword">Confirm New Password</label>
                <div class="pw-input-wrap">
                  <input id="confirmPassword" class="pw-input" type="password" minlength="6" required />
                  <button class="pw-toggle" type="button" data-target="confirmPassword" aria-label="Show confirm password">
                    <span class="material-symbols-rounded">visibility</span>
                  </button>
                </div>

                <div class="pw-hint">Use at least 6 characters.</div>

                <button class="btn" id="btnChangePassword" type="submit">
                  <span class="material-symbols-rounded">key</span>
                  Update Password
                </button>
              </form>
            </div>
          </div>

          <!-- Right: Charts + Stats + Recent -->
          <div class="stack">
            <!-- Charts Section -->
            <div class="charts-grid">
              <div class="card">
                <div class="card-title">
                  <span class="material-symbols-rounded">pie_chart</span>
                  Entry Status Distribution
                </div>
                <canvas id="statusChart" height="280"></canvas>
              </div>

              <div class="card">
                <div class="card-title">
                  <span class="material-symbols-rounded">bar_chart</span>
                  Monthly Activity (Last 6 Months)
                </div>
                <canvas id="monthlyChart" height="280"></canvas>
              </div>
            </div>

            <!-- Stats Grid -->
            <div class="stats-grid">
              <div class="stat-card stat-added">
                <div class="k"><span class="material-symbols-rounded">add_circle</span> Total Added</div>
                <div class="v" id="stAdded">0</div>
              </div>

              <div class="stat-card stat-moved">
                <div class="k"><span class="material-symbols-rounded">swap_horiz</span> Total Moved</div>
                <div class="v" id="stMoved">0</div>
              </div>

              <div class="stat-card stat-ongoing">
                <div class="k"><span class="material-symbols-rounded">schedule</span> Ongoing</div>
                <div class="v" id="stOngoing">0</div>
              </div>

              <div class="stat-card stat-closed">
                <div class="k"><span class="material-symbols-rounded">check_circle</span> Closed</div>
                <div class="v" id="stClosed">0</div>
              </div>

              <div class="stat-card stat-section">
                <div class="k"><span class="material-symbols-rounded">folder</span> In Section</div>
                <div class="v" id="stInSection">0</div>
              </div>

              <div class="stat-card stat-central">
                <div class="k"><span class="material-symbols-rounded">account_balance</span> In Central</div>
                <div class="v" id="stInCentral">0</div>
              </div>
            </div>

            <!-- Recent Activity -->
            <div class="card">
              <div class="card-title">
                <span class="material-symbols-rounded">history</span>
                Recent Activity
              </div>
              <div id="stRecent" class="recent">
                Loading...
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script type="module">
    import { initLayout } from "./js/layout.js";
    import "./js/profile.js";
    initLayout("profile");
    // ✅ Charts & DateTime handled by profile.js - no duplicate code
  </script>
</body>
</html>
